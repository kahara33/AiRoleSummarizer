import { sendProgressUpdate, sendAgentThoughts } from './server/websocket/ws-server';

// 詳細なエージェント思考メッセージのテスト
function testDetailedAgentThoughts() {
  console.log('WebSocketメッセージテスト開始 - 詳細な思考プロセス');
  const roleModelId = 'test-role-model-123';
  
  try {
    // 進捗更新メッセージ
    sendProgressUpdate({
      message: 'マルチエージェント分析プロセスを開始します',
      percent: 10,
      roleModelId
    });
    console.log('進捗更新メッセージを送信しました');
    
    // ドメイン分析者の詳細な思考
    setTimeout(() => {
      sendAgentThoughts(
        'ドメイン分析者', 
        `ドメイン分析を開始します。ターゲットは「Webマーケティングコンサルにおけるエージェント活用」です。

1. まずは業界の概要を理解する必要があります。Webマーケティングコンサルティング業界の主要セグメントを特定し、市場規模と成長率を調査します。
2. 次に、主要なプレイヤーと彼らのサービス提供を分析します。大手Webマーケティングコンサルティング企業だけでなく、特化型のニッチプレイヤーも重要です。
3. クライアントのニーズと課題を明確にします。何を求めているのか、どのような問題に直面しているのかを深掘りします。
4. 現在のAIエージェント活用状況を調査します。既存のソリューションと採用率、そして成功事例と失敗事例を収集します。

これらの情報を基に、クライアントのビジネスにおけるAIエージェント活用の機会を特定していきます。`, 
        roleModelId,
        {
          agentType: 'thinking',
          step: 'domain-analysis'
        }
      );
      console.log('ドメイン分析者の詳細な思考を送信しました');
    }, 1000);
    
    // トレンド調査者の詳細な思考
    setTimeout(() => {
      sendAgentThoughts(
        'トレンド調査者', 
        `Webマーケティングコンサルにおけるトレンド調査を実施します。

1. 飲食店、美容院、宿泊施設向けWebマーケティングにおけるAIエージェント事例を検索しています。
   - 具体的なタスク内容や開発手法、導入プロセスは重要な情報です。
   - 主要なサービス提供者やツールについても確認します。

2. 「AIマーケティングコンサルの自動化事例」について検索しました。
   - 検索結果が広範で、AI面接や求人関連のものが多く含まれています。
   - 担当者がAIを使って会議やプロポーザルを設計するプロセスについての情報があります。
   - さらに深堀するため、大飯 記事を再検討して具体的な内容を抽出します。

3. 「AIエージェント コンサル提案 レストランマーケティング」で検索を進めています。
   - 「Colega-ai」という会社やYouTubeリンクが見つかりました。初期の検索結果を確認中です。

4. Colega AIは飲食店Webマーケティングに特化しているようです。彼らの提供するサービスモデルと導入事例を詳しく調査します。

これらの情報から、最新のトレンドと成功事例を抽出し、ドメイン分析者と共有していきます。`, 
        roleModelId,
        {
          agentType: 'info',
          step: 'trend-research'
        }
      );
      console.log('トレンド調査者の詳細な思考を送信しました');
    }, 3000);
    
    // コンテキストマッパーの詳細な思考
    setTimeout(() => {
      sendAgentThoughts(
        'コンテキストマッパー', 
        `ドメイン分析者とトレンド調査者から受け取った情報を基にコンテキストマッピングを行います。

1. コンテキスト分析:
   - 飲食店・美容院・宿泊施設向けWebマーケティングという特定の垂直市場がターゲットです
   - AIエージェントの活用は、既存のマーケティングプロセスの効率化と拡張が主な目的
   - クライアントの痛点は、個別化されたマーケティング戦略の開発に時間がかかることと、データ分析の複雑さ

2. 関係性のマッピング:
   - Colega AIのような専門企業が既に飲食店向けに特化したソリューションを提供しています
   - AIツールは主に以下の領域で活用されています:
     a) ターゲットオーディエンス分析
     b) コンテンツ生成と最適化
     c) パフォーマンス予測と分析
     d) 競合分析と市場ポジショニング

3. ギャップ分析:
   - 美容院と宿泊施設向けの特化型AIソリューションはまだ十分に開発されていない
   - 導入プロセスの標準化と効果測定の方法論にも改善の余地がある
   - クライアントの業態や規模に応じたカスタマイズ可能なソリューションが少ない

これらの分析結果を構造化し、情報収集計画の策定に活用します。`, 
        roleModelId,
        {
          agentType: 'thinking',
          step: 'context-mapping'
        }
      );
      console.log('コンテキストマッパーの詳細な思考を送信しました');
    }, 5000);
    
    // 計画戦略家の詳細な思考
    setTimeout(() => {
      sendAgentThoughts(
        '計画戦略家', 
        `収集した情報とコンテキストマッピングを基に、情報収集と分析の戦略計画を立案します。

1. 優先調査分野の特定:
   - 飲食店向けAIマーケティングの成功事例 (Colega AIの事例を詳細分析)
   - 美容院・宿泊施設向けAIマーケティングの既存ソリューションと導入障壁
   - AIエージェントを活用した競合分析と市場ポジショニング手法の最新事例
   - コンサルタントがAIを活用してクライアント提案を効率化する方法と事例

2. データ収集方法:
   - 業界レポートと専門誌の分析 (Gartner、Forrester、マーケティング専門誌)
   - 主要AIマーケティングプラットフォームの機能比較 (HubSpot AI、Marketo AI、カスタムAIソリューション)
   - 実際の導入事例インタビューやケーススタディ (最低5つの異なる規模・業態のビジネス)
   - ソーシャルメディアとプロフェッショナルコミュニティでの議論分析 (Reddit、LinkedIn、専門フォーラム)

3. 分析フレームワーク:
   - ROI分析: AIエージェント導入コストvs.マーケティング効率向上の経済的効果
   - 導入難易度マトリクス: 技術的複雑さvs.組織的受容性
   - 競争優位性評価: 独自性、模倣困難性、持続可能性の観点からの評価
   - クライアント満足度指標: NPS向上、リテンション率改善、アップセル機会の増加

この戦略計画に基づいて、効率的かつ包括的な情報収集を進めていきます。`, 
        roleModelId,
        {
          agentType: 'info',
          step: 'strategy-planning'
        }
      );
      console.log('計画戦略家の詳細な思考を送信しました');
    }, 7000);
    
    // 批判的思考者の詳細な思考
    setTimeout(() => {
      sendAgentThoughts(
        '批判的思考者', 
        `これまでの分析プロセスと計画を批判的に評価し、潜在的な問題点や偏りを指摘します。

1. 情報収集の偏りに関する懸念:
   - 飲食店向けのAIマーケティングソリューション(Colega AI)に過度に焦点を当てすぎていないか
   - 成功事例だけでなく、失敗事例やAI導入の障壁についての十分な調査がなされているか
   - 地域的な違い（日本市場vs海外市場）についての考慮が不足していないか

2. 分析フレームワークの限界:
   - ROI分析は短期的な経済効果に偏りがちで、長期的な組織変革の価値を見落とす可能性
   - 技術的な側面に注目しすぎて、実際のユーザー（マーケティングコンサルタント）の日常業務への統合という観点が不足
   - AIエージェント導入の倫理的側面（データプライバシー、意思決定の透明性など）が考慮されていない

3. 計画における欠落点:
   - AIマーケティングツールの限界と人間による補完が必要な領域の特定が不十分
   - 教育・トレーニング・変化管理といった導入後の継続的サポート要素が計画に含まれていない
   - 急速に変化するAI技術に対応するための持続可能なアップデート戦略が欠けている

4. 代替的視点の提案:
   - AIの完全活用よりも、人間とAIのハイブリッドアプローチが最適かもしれない
   - 業種別の特化型ソリューションより、カスタマイズ可能な汎用プラットフォームの方が適している可能性
   - 大規模な変革よりも、段階的な小さな実験とフィードバックループを通じた導入が効果的かもしれない

これらの批判的視点を踏まえ、より堅牢で包括的な情報収集計画への修正を提案します。`, 
        roleModelId,
        {
          agentType: 'thinking',
          step: 'critical-analysis'
        }
      );
      console.log('批判的思考者の詳細な思考を送信しました');
    }, 9000);
    
    // 進捗更新 - 70%
    setTimeout(() => {
      sendProgressUpdate({
        message: 'マルチエージェント分析プロセスが進行中です',
        percent: 70,
        roleModelId
      });
    }, 10000);
    
  } catch (error) {
    console.error('WebSocketメッセージテストエラー:', error);
  }
}

// 実行
console.log('診断スクリプト開始');
testDetailedAgentThoughts();
console.log('診断スクリプト完了 - 各メッセージは非同期で送信されます');